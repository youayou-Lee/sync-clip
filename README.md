# Sync Clip - 跨设备剪贴板共享工具

一个基于Python的跨设备剪贴板共享工具，支持文本和图片在多台设备间实时同步，具备自动设备发现功能。

## 功能特点

### 核心功能
- 🔄 **实时同步**: 在多台设备间实时同步剪贴板内容
- 📝 **文本支持**: 支持纯文本内容的快速同步
- 🖼️ **图片支持**: 支持图片剪贴板内容的同步
- 💻 **跨平台**: 支持Windows、macOS和Linux系统
- 🎯 **简单易用**: 简洁的图形用户界面，操作直观
- 🔒 **局域网通信**: 基于局域网的通信，保证数据传输安全

### 🆕 设备发现功能
- 🔍 **自动设备发现**: 启动时自动搜索局域网内的其他运行实例
- 📱 **实时设备列表**: 显示所有已连接设备的状态和平台信息
- 💚 **设备状态监控**: 实时显示设备在线状态（绿色=在线，橙色=离线）
- 🌐 **跨平台识别**: 自动识别Windows、Linux、macOS等不同平台设备
- 📢 **设备事件通知**: 当设备加入或离开网络时显示通知
- 🔄 **智能重连**: 设备断线后自动重新发现和连接

## 系统要求

- Python 3.13+
- 支持的操作系统：Windows、macOS、Linux

## 安装步骤

1. 克隆项目到本地：
```bash
git clone https://github.com/youayou-Lee/sync-clip.git
cd sync-clip
```

2. 使用uv安装依赖：
```bash
uv sync
```

## 使用方法

### 基本使用

1. 启动应用程序：
```bash
uv run python main.py
```

2. **设备自动发现**: 应用程序启动后会自动搜索局域网内的其他设备，无需手动配置

3. **界面布局**:
   - **左侧**: 剪贴板历史记录区域
   - **右侧**: 连接设备列表（实时显示所有在线设备）
   - **底部**: 状态栏（显示设备加入/离开通知）

4. **剪贴板同步**: 在任何一台设备上复制文本或图片，内容会自动同步到其他设备

5. **历史记录**: 在历史记录中可以查看之前的剪贴板内容，点击"复制到剪贴板"按钮可以重新使用

### 设备管理

- **查看设备**: 右侧面板实时显示所有连接的设备信息
  - 设备名称（带平台颜色标识：Windows=蓝色，Linux=绿色，macOS=紫色）
  - IP地址和操作系统类型
  - 实时在线状态指示器
  - 最后在线时间

- **手动刷新**: 点击"刷新设备"按钮重新搜索网络中的设备

- **设备事件**: 状态栏会显示设备加入/离开的实时通知

## 项目结构

```
sync-clip/
├── main.py                 # 主程序入口
├── src/
│   ├── ui/
│   │   └── app.py         # 图形用户界面
│   ├── core/
│   │   └── clipboard_manager.py  # 剪贴板管理核心逻辑
│   ├── platforms/
│   │   ├── clipboard_monitor.py  # 剪贴板监控
│   │   └── network.py     # 网络通信模块
│   └── interfaces/
│       └── __init__.py    # 数据接口定义
├── pyproject.toml         # 项目配置和依赖
└── README.md             # 项目说明文档
```

## 核心模块说明

- **ClipboardManager**: 剪贴板管理核心，负责处理剪贴板数据的读取、写入和历史管理
- **ClipboardMonitor**: 剪贴板监控器，实时检测剪贴板变化
- **Network**: 网络通信模块，处理设备间的数据传输
- **App**: 图形用户界面，提供友好的操作体验

## 依赖库

- `pillow>=10.0.0` - 图片处理库，支持图片的读取和处理
- `pyperclip>=1.8.0` - 剪贴板操作库，提供跨平台的剪贴板访问
- `psutil>=5.9.0` - 系统信息获取库，用于获取系统信息

## 使用说明

1. **网络配置**: 确保所有设备在同一个局域网内
2. **防火墙设置**: 如果遇到连接问题，请检查防火墙设置
3. **多设备使用**: 在每台需要同步的设备上运行此应用程序

## 测试工具

项目提供了多个测试工具来验证功能：

### 设备发现测试
```bash
# 单设备网络测试
uv run python simple_device_test.py

# 多设备测试（同一台机器）
uv run python multi_device_test.py --instances 2 --duration 30

# 指定端口测试
uv run python multi_device_test.py --port 5560 --duration 60
```

### 基础设备发现
```bash
# 基本设备发现功能测试
uv run python test_device_discovery.py
```

## 网络配置

### 端口使用
- **默认端口**: 5555
- **广播端口**: 5555-5559 (自动遍历)
- **动态端口**: 如果默认端口被占用，自动分配下一个可用端口

### 防火墙设置
确保以下端口在防火墙中允许UDP通信：
- 5555-5559 (UDP广播端口)
- 应用程序实际绑定的端口

## 故障排除

### 设备未发现
1. **检查网络连接**: 确保设备在同一局域网内
2. **防火墙设置**: 允许UDP广播通信
3. **端口冲突**: 使用不同的启动端口：`uv run python main.py --port 5560`
4. **重启应用**: 重新启动应用程序触发设备发现

### 连接不稳定
1. **网络延迟**: 检查网络质量
2. **防火墙干扰**: 临时禁用防火墙测试
3. **路由器设置**: 检查路由器是否支持UDP广播

### 界面问题
1. **依赖缺失**: 运行 `uv sync` 安装所有必需的Python包
2. **权限问题**: 确保有剪贴板访问权限
3. **平台兼容**: 检查是否支持当前操作系统

## 注意事项

- 目前支持文本和PNG格式图片的同步
- 网络通信基于局域网，确保设备间的网络连通性
- 历史记录会在程序关闭时清空
- 无论哪台设备先启动，都能自动发现其他设备
- 支持跨平台设备发现和识别

## 贡献

欢迎提交Issue和Pull Request来改进这个项目。

## 许可证

本项目采用MIT许可证，详情请参阅LICENSE文件。

## 更新日志

### v2.0.0 - 设备发现版本 🆕
- ✨ **设备自动发现**: 启动时自动搜索局域网内的其他运行实例
- ✨ **实时设备列表**: 右侧面板显示所有连接设备的状态和平台信息
- ✨ **设备状态监控**: 实时显示设备在线状态（绿色=在线，橙色=离线）
- ✨ **跨平台识别**: 自动识别Windows、Linux、macOS等不同平台设备
- ✨ **设备事件通知**: 设备加入/离开时显示实时通知
- ✨ **动态端口绑定**: 自动选择可用端口，避免端口冲突
- ✨ **多端口广播**: 同时广播到多个常用端口，提高连接成功率
- ✨ **设备心跳机制**: 定期发送心跳包维持设备连接状态
- ✨ **智能重连**: 设备断线后自动重新发现和连接
- 🎨 **界面优化**: 新的布局设计，更好的用户体验
- 🧪 **测试工具**: 添加多个测试工具用于验证设备发现功能

### v0.1.0 - 初始版本
- 初始版本发布
- 支持基本的文本和图片剪贴板同步
- 简洁的图形用户界面
- 基于UDP广播的局域网通信